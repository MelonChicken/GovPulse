# Government Website Status Monitor

정부 웹사이트(.go.kr) 상태를 **저부하**로 모니터링하는 FastAPI 기반 도구

## 📑 목차

- [프로젝트 개요](#프로젝트-개요)
- [프로젝트 구성](#-프로젝트-구성)
- [빠른 실행](#️-빠른-실행)
- [구현체별 특징](#-구현체별-특징)
- [사용 시나리오](#-사용-시나리오)
- [공통 법적 준수사항](#-공통-법적-준수사항)
- [상세 문서](#-상세-문서)
- [모니터링 사이트 추가 방법](#-모니터링-사이트-추가-방법)
- [Healthy 판단 로직](#-healthy-판단-로직)
- [최근 변경사항](#-최근-변경사항)
- [주의사항](#-주의사항)
- [라이선스](#-라이선스)

## 프로젝트 개요
이 프로젝트는 최근 (2025.9.26. 20:15) 발생한 국가정보자원관리원의 화재 사고의 영향으로 정부 사이트 및 전산이 마비됨에 따라 주요 사이트의 복구 여부를 한눈에 보기 위해 만들어진 프로젝트 입니다.

기술 스택은 FastAPI를 기반으로 가벼우면서 빠른 개발을 지향하였고 Claude code로 빠른 시간 내에 개발을 목표로 프로젝트를 진행하였습니다.
이에 따라 아직 (2025.9.29.)은 프로젝트의 구조가 불안정한 상태이며 healthy 판단 로직 또한 정리되지 않은 프로토타입만이 존재하는 상황입니다.

그렇기에 언제든지 개선점에 대한 의견을 주시면 감사하겠습니다.
현재 이 프로젝트의 협업 방식은 pull request로 신청시 검토후 반영 (만약 현재 레포지토리로 업로드를 희망하시는 경우) 혹은 독자적 개발을 채택하고 있습니다.

## 🔀 프로젝트 구성

### 1. 🐍 기본 FastAPI 버전
- **파일**: `main.py`, `endpoints.yaml`
- **용도**: 빠른 테스트 및 개발

### 2. 🏭 프로덕션 FastAPI + Caddy 버전
- **디렉토리**: `politeping/`
- **용도**: HTTPS 자동 인증서, systemd 서비스

### 3. 🔍 헬스체크 스크립트
- **파일**: `healthcheck.py`, `healthcheck_enhanced.py`
- **용도**: 오프라인 일괄 상태 검사

## 🏃‍♂️ 빠른 실행

### 1. 기본 FastAPI (개발용)
```bash
pip install requests fastapi uvicorn pyyaml
uvicorn main:app --reload
# 접속: http://localhost:8000
```

### 2. 헬스체크 스크립트 (일괄 검사)
```bash
pip install requests
python healthcheck.py --create-samples  # 샘플 파일 생성
python healthcheck.py --urls urls.txt --keywords keywords.json
```

### 3. 프로덕션 배포
- **FastAPI + Caddy**: `politeping/README.md` 참조

## 📊 구현체별 특징

| 구성요소 | 용도 | 주요 기능 |
|---------|------|-----------|
| **기본 FastAPI** | 개발/테스트 | robots.txt 가드, 실시간 웹 모니터링, 간소화된 상태 표시 |
| **FastAPI + Caddy** | 프로덕션 배포 | HTTPS 자동화, systemd 서비스, 고성능, 키워드 기반 장애 감지 |
| **헬스체크 스크립트** | 오프라인 검사 | 일괄 처리, CSV 출력, 키워드 감지 |

## 🎯 사용 시나리오

### 🧪 개발/테스트 단계
- **사용**: 기본 FastAPI (`main.py`)
- **장점**: 빠른 시작, 실시간 수정, 로컬 환경

## 🔒 공통 법적 준수사항

모든 구현체가 동일한 법적 안전 기준을 따릅니다:

### ✅ 준수 사항
- **공개 페이지만**: 인증 불필요한 대표 페이지만
- **robots.txt 완전 준수**: Disallow 경로는 요청 안 함
- **실시간 모니터링**: 새로고침할 때마다 실제 상태 확인 (하지만 과도한 트래픽은 차단)
- **최소 요청**: HEAD 우선, 필요시 GET 첫 청크

### ❌ 금지 사항
- 비공개 경로 접근 (`/admin`, `/login` 등)
- 개인정보 수집 (폼 제출, 쿠키 등)
- 대량 요청 (레이트 제한 우회)
- 콘텐츠 저장 (크롤링/스크래핑)

## 📚 상세 문서

| 구성요소 | 문서 위치 | 설명 |
|---------|-----------|------|
| 기본 FastAPI | `main.py` 코드 참조 | 단일 파일 구현 |
| 프로덕션 FastAPI + Caddy | `politeping/README.md` | 전체 스택 배포 |
| 헬스체크 스크립트 | `healthcheck_usage.md` | 오프라인 모니터링 |

## 🌐 모니터링 사이트 추가 방법

### 1. 기본 FastAPI 버전 (`main.py`)

**설정 파일**: `endpoints.yaml`

```yaml
endpoints:
  - name: "사이트 표시명"
    url: "https://example.go.kr/"
    keywords: ["핵심키워드1", "핵심키워드2"]
```

**예시 추가**:
```yaml
  - name: "국세청 홈택스"
    url: "https://www.hometax.go.kr/"
    keywords: ["홈택스", "국세청", "HOMETAX"]
```

### 2. 프로덕션 FastAPI + Caddy 버전

**설정 파일**: `politeping/endpoints.yaml`

```yaml
endpoints:
  - name: "사이트 표시명"
    url: "https://example.go.kr/"
```

**예시 추가**:
```yaml
  - name: "국세청 홈택스"
    url: "https://www.hometax.go.kr/"
```

### 3. 헬스체크 스크립트 버전

**URL 목록 파일** (예: `urls.txt`):
```
https://example1.go.kr/
https://example2.go.kr/
```

**키워드 설정 파일** (`keywords.json`):
```json
{
  "https://example1.go.kr/": ["키워드1", "키워드2"],
  "https://example2.go.kr/": ["키워드3", "키워드4"]
}
```

### 📋 사이트 추가 체크리스트

#### ✅ 추가 전 필수 확인사항
- [ ] `.go.kr` 도메인인지 확인
- [ ] 공개 접근 가능한 메인 페이지인지 확인
- [ ] `robots.txt` 확인 (`https://사이트주소/robots.txt`)
- [ ] 인증이 필요하지 않은 페이지인지 확인

#### 🎯 키워드 선택 가이드
- **필수**: 사이트의 핵심 브랜드명
- **권장**: 서비스의 주요 기능명
- **예시**:
  - 정부24 → `["정부24", "Government 24"]`
  - 홈택스 → `["홈택스", "국세청", "HOMETAX"]`

#### 🚫 추가하면 안 되는 사이트
- 인증이 필요한 관리자 페이지 (`/admin`, `/login`)
- 개인정보가 포함된 페이지
- `robots.txt`에서 접근을 금지한 경로
- 테스트/개발 환경 사이트

### 💡 사이트 추가 후 확인

1. **설정 파일 저장** 후 서비스 재시작
2. **웹 대시보드**에서 새 사이트 표시 확인
3. **상태 체크** 정상 작동 확인
4. **키워드 감지** 테스트 (해당하는 경우)

## 🔄 최근 변경사항

- **SKIPPED 상태 제거**: 더 이상 "Rate Limited" 표시 없음
- **실시간 체크**: 새로고침할 때마다 무조건 실제 요청 수행
- **간소화된 상태**: Healthy/Unhealthy/Error 3가지로 단순화
- **UI 개선**: 모든 대시보드에서 일관된 상태 표시

## 🚨 주의사항

1. **이메일 주소**: 반드시 실제 연락 가능한 이메일로 설정
2. **모니터링 대상**: .go.kr 도메인만 추가할 것
3. **운영자 요청**: 사이트 운영자가 제외 요청시 즉시 반영
4. **새로고침 주의**: 실시간 요청으로 변경되어 과도한 새로고침 자제

## 📄 라이선스

기본적으로 MIT 라이센스를 기반으로 하고 있으나, 프로젝트의 특성상 일부 제한을 추가하고 있습니다.
교육 및 공익 목적으로 제공됩니다. 상업적 이용 전 법적 검토 필요.

본 사이트는 공공 웹페이지( .go.kr )의 공개 엔드포인트에 대해
실시간 모니터링 방식으로 HEAD/경량 GET 요청을 보내
현재 응답 상태를 표시합니다. 

인증이 필요한 페이지·비공개 영역은
점검하지 않으며, 페이지 본문/개인정보를 저장하지 않습니다.
공적인 목적으로의 요청 제한이나 모니터링 제외 요청이 있을 경우 즉시 반영합니다.

문의 : m.l02n23@gmail.com
